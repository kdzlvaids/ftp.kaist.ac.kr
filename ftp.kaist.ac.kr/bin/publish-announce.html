#!/usr/bin/env bash
# publish-announce.html -- Publish announce.feed in HTML
# 
# Created: 2006-07-16
# 
# Written by Jaeho Shin <netj@sparcs.org>.
# (C) 2006, Geoul Project. (http://ftp.kaist.ac.kr/geoul)
set -e
. /mirror/lib/geoul.sh
running_as_mirror_admin "$@"

cd /mirror/ftp
tmp=`mktemp /tmp/announce.html.XXXXXX`
trap "rm $tmp" EXIT ERR HUP INT TERM
chmod a+r $tmp

set +e
for feed in announce.feed*; do
    html=.announce.html${feed#announce.feed}
    [ $feed -nt $html ] || continue
    (
    set -e
    allim $feed html-list >$tmp
    cp -f $tmp $html
    )
done

# vim:ft=sh
